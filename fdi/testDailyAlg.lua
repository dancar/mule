require 'calculate_fdi'

local filePath = './fdi/fixtures/graphs_of_interest.txt'
--local filePath = './fixtures/graphs_of_interest.txt'

local matlab = {
[1] = { [1] = {57, 5979160, -70}, [2] = {58, 5959533, -139}, [3] = {59, 5866858, -209}, [4] = {63, 5757101, -69}, [5] = {72, 5580421, -53}, [6] = {73, 5572093, -122}, [7] = {75, 4179768, -2}, [8] = {78, 5855654, -60}, [9] = {83, 5338202, -4}, [10] = {84, 5635739, -6}, [11] = {87, 5504092, -5}, [12] = {90, 2570927, -44}, [13] = {95, 2641673, -64}, [14] = {96, 1966663, -73}, [15] = {105, 3146427, -46}, [16] = {128, 2688770, -45}, [17] = {129, 2277191, -77}, [18] = {155, 3081107, -53}, [19] = {159, 2376377, -54}, [20] = {160, 3257391, -120}, [21] = {173, 2428307, -42}, [22] = {174, 3120216, -92}, [23] = {193, 2813229, -65}, [24] = {194, 2408958, -99}, [25] = {195, 3415413, -141}, [26] = {197, 3117969, -37}, [27] = {198, 3650395, -98}, [28] = {227, 3936059, 6}, [29] = {228, 2986982, 9}, [30] = {229, 2705054, 10}, [31] = {237, 6758170, -4}, [32] = {238, 7381924, -8}, [33] = {242, 4576475, -5}, [34] = {255, 3195252, -3}, [35] = {311, 9815171, -11}, [36] = {328, 8632362, -4}, [37] = {334, 5870704, -5}},
[2] = { [1] = {46, 40375, -26}, [2] = {59, 59052, -39}, [3] = {60, 43603, -59}, [4] = {65, 62666, -39}, [5] = {82, 39284, -2}, [6] = {83, 65706, -5}, [7] = {84, 64889, -9}, [8] = {85, 64000, -12}, [9] = {89, 21217, -22}, [10] = {101, 0, 34}, [11] = {102, 0, 55}, [12] = {118, 38035, -31}, [13] = {120, 34091, -35}, [14] = {121, 33813, -70}, [15] = {122, 33427, -72}, [16] = {136, 30003, -30}, [17] = {149, 27839, -32}, [18] = {176, 34341, -6}, [19] = {225, 37266, 2}, [20] = {226, 40327, 5}, [21] = {227, 39598, 7}, [22] = {228, 27299, 10}, [23] = {229, 45698, 14}, [24] = {230, 68430, 19}, [25] = {238, 95719, -4}, [26] = {240, 87372, -3}, [27] = {241, 69236, -8}, [28] = {242, 47767, -10}, [29] = {246, 81196, -5}, [30] = {255, 32883, -7}, [31] = {270, 40380, 4}, [32] = {273, 46639, 5}, [33] = {311, 118089, -11}, [34] = {334, 83466, -9}},
[3] = { [1] = {45, 127205, -44}, [2] = {47, 106196, -40}, [3] = {48, 143000, -76}, [4] = {67, 98885, -42}, [5] = {68, 93904, -74}, [6] = {72, 124565, -38}, [7] = {73, 114758, -73}, [8] = {78, 131200, -41}, [9] = {87, 93456, -23}, [10] = {93, 0, 32}, [11] = {98, 102898, -36}, [12] = {99, 99019, -64}, [13] = {101, 90384, -18}, [14] = {111, 102524, 4}, [15] = {113, 108768, -22}, [16] = {121, 0, 31}, [17] = {176, 106849, -2}, [18] = {204, 123638, 3}, [19] = {205, 124228, 6}, [20] = {229, 112541, 5}, [21] = {230, 142606, 12}, [22] = {231, 140359, 14}, [23] = {255, 203356, -15}, [24] = {311, 332675, -18}, [25] = {316, 375221, 6}, [26] = {322, 438800, 6}, [27] = {323, 385951, -3}, [28] = {324, 415690, 5}, [29] = {325, 396857, 8}, [30] = {326, 319085, 13}, [31] = {327, 333955, 18}, [32] = {329, 1149453, 5}, [33] = {331, 961390, -5}, [34] = {332, 939109, -8}, [35] = {333, 762123, -14}, [36] = {334, 797630, -30}},
[4] = { [1] = {15, 1069, 5}, [2] = {20, 1185, 3}, [3] = {23, 985, -2}, [4] = {25, 885, -4}, [5] = {28, 1254, -4}, [6] = {29, 1166, 3}, [7] = {30, 933, 6}, [8] = {31, 875, 9}, [9] = {36, 3733, 4}, [10] = {39, 881, 8}, [11] = {40, 725, 12}, [12] = {50, 2100, -4}, [13] = {52, 1257, -6}, [14] = {53, 783, -10}, [15] = {63, 3256, -6}, [16] = {64, 1749, -9}, [17] = {75, 827, 18}, [18] = {76, 1065, -3}, [19] = {87, 709, -3}, [20] = {115, 406, -2}, [21] = {145, 102, 3}, [22] = {146, 354, 6}, [23] = {147, 371, 11}, [24] = {148, 566, 13}, [25] = {162, 7084, -2}, [26] = {165, 2350, -5}, [27] = {204, 486, 2}, [28] = {255, 2128, -2}, [29] = {299, 809, 2}, [30] = {309, 3314, 3}, [31] = {311, 2650, -2}},
[5] = { [1] = {21, 1235959, -10}, [2] = {24, 1478911, -2}, [3] = {25, 1451029, -5}, [4] = {26, 1506760, -8}, [5] = {27, 1304509, -12}, [6] = {65, 850421, -57}, [7] = {105, 566222, -2}, [8] = {106, 976441, -6}, [9] = {107, 964958, -10}, [10] = {108, 926999, -13}, [11] = {109, 925373, -16}, [12] = {199, 402660, -7}, [13] = {248, 405418, 2}, [14] = {249, 386409, 5}, [15] = {250, 365167, 8}, [16] = {251, 259661, 11}, [17] = {259, 463635, -2}, [18] = {260, 847315, -5}, [19] = {263, 726549, -3}, [20] = {264, 666707, -9}, [21] = {265, 453227, -12}, [22] = {268, 742367, -4}, [23] = {269, 800711, -7}, [24] = {278, 287512, -3}, [25] = {284, 751426, -4}, [26] = {293, 281726, 2}, [27] = {308, 443084, 3}, [28] = {334, 1042180, -8}, [29] = {357, 887947, -7}},
[6] = { [1] = {25, 49554472, 5}},
[7] = { [1] = {43, 107332, -3}, [2] = {47, 88892, -3}, [3] = {49, 103341, -6}, [4] = {66, 70039, -2}, [5] = {76, 65757, 4}, [6] = {77, 45700, 4}, [7] = {82, 39889, -23}, [8] = {83, 82241, -49}, [9] = {85, 67074, -4}, [10] = {86, 79156, -6}, [11] = {89, 43436, -4}, [12] = {104, 38728, -18}, [13] = {142, 62718, -29}, [14] = {143, 62640, -49}, [15] = {151, 44081, -20}, [16] = {152, 44970, -41}, [17] = {155, 55093, -28}, [18] = {168, 53780, -12}, [19] = {171, 53166, -5}, [20] = {172, 39438, -7}, [21] = {173, 21988, -9}, [22] = {190, 9937, 4}, [23] = {191, 13424, 8}, [24] = {192, 12005, 10}, [25] = {193, 8808, 12}, [26] = {205, 42097, -4}, [27] = {227, 38739, 3}, [28] = {228, 34551, 6}, [29] = {237, 124837, -2}, [30] = {255, 54693, -2}, [31] = {258, 53656, -17}, [32] = {259, 81938, -30}, [33] = {286, 108103, 4}, [34] = {311, 125939, -6}, [35] = {326, 89384, -5}},
[8] = { [1] = {43, 2743344, -64}, [2] = {44, 2656444, -129}, [3] = {76, 2735172, -64}, [4] = {77, 2696884, -129}, [5] = {82, 2030913, -62}, [6] = {85, 2496452, -61}, [7] = {93, 2066834, -51}, [8] = {106, 0, 51}, [9] = {133, 2257714, -63}, [10] = {134, 2259307, -112}, [11] = {135, 2286818, -169}, [12] = {159, 1953042, -8}, [13] = {174, 1980865, -5}, [14] = {176, 1243706, -6}, [15] = {180, 434179, -32}, [16] = {189, 1018274, 3}, [17] = {191, 1010544, 3}, [18] = {192, 1082952, 5}, [19] = {195, 1258301, -3}, [20] = {250, 2105460, -4}, [21] = {255, 1972409, -8}, [22] = {311, 2753454, -17}, [23] = {334, 1530322, -8}},
[9] = { [1] = {42, 2228771, -63}, [2] = {48, 2186217, -63}, [3] = {61, 1736399, -61}, [4] = {62, 1954047, -108}, [5] = {64, 2020271, -48}, [6] = {65, 1925494, -110}, [7] = {70, 1941013, -50}, [8] = {71, 768, -58}, [9] = {86, 1694471, -51}, [10] = {87, 1655762, -112}, [11] = {88, 1494290, -172}, [12] = {89, 1481595, -226}, [13] = {90, 19, 42}, [14] = {91, 7, 84}, [15] = {92, 0, 116}, [16] = {93, 11, 151}, [17] = {106, 1647985, -31}, [18] = {110, 1432731, -60}, [19] = {111, 1479623, -107}, [20] = {112, 1403901, -151}, [21] = {116, 1157308, -46}, [22] = {121, 1699205, -46}, [23] = {124, 0, 18}, [24] = {125, 1798019, -34}, [25] = {131, 1453908, -5}, [26] = {148, 1839608, -41}, [27] = {149, 1812650, -85}, [28] = {172, 1428764, -5}, [29] = {182, 919561, -42}, [30] = {183, 601070, -63}, [31] = {184, 852737, -98}, [32] = {192, 888588, 3}, [33] = {193, 707154, 6}, [34] = {194, 651634, 9}, [35] = {195, 960959, -43}, [36] = {196, 1305659, -67}, [37] = {198, 860468, 3}, [38] = {242, 1913032, -3}, [39] = {250, 2078595, -4}, [40] = {255, 1834557, -9}, [41] = {285, 1091355, 3}, [42] = {311, 1944765, -18}, [43] = {328, 2021034, -5}, [44] = {329, 1308930, 3}, [45] = {334, 812774, -4}},
[10] = { [1] = {42, 109924, -41}, [2] = {46, 68904, -26}, [3] = {47, 74666, -58}, [4] = {51, 104753, -43}, [5] = {52, 103726, -76}, [6] = {57, 112112, -43}, [7] = {83, 119596, -3}, [8] = {84, 123879, -7}, [9] = {87, 105415, -6}, [10] = {94, 62944, 6}, [11] = {95, 33434, 16}, [12] = {96, 30907, 23}, [13] = {97, 75328, 27}, [14] = {98, 70955, 32}, [15] = {99, 64613, 37}, [16] = {100, 83085, 40}, [17] = {102, 106904, -3}, [18] = {103, 98849, -7}, [19] = {104, 194090, -12}, [20] = {105, 226506, -17}, [21] = {116, 32678, -15}, [22] = {117, 30208, -33}, [23] = {118, 67793, -65}, [24] = {147, 60955, -36}, [25] = {148, 58040, -68}, [26] = {176, 55294, -5}, [27] = {200, 37787, 4}, [28] = {230, 93709, 4}, [29] = {238, 170626, -5}, [30] = {240, 170518, -4}, [31] = {241, 200967, -8}, [32] = {242, 126301, -10}, [33] = {246, 166444, -5}, [34] = {255, 50492, -5}, [35] = {311, 108126, -7}, [36] = {319, 78627, -9}, [37] = {320, 77829, -19}, [38] = {321, 122681, -24}, [39] = {323, 51732, 5}, [40] = {326, 11007, 6}, [41] = {327, 10385, 10}, [42] = {330, 88223, -4}, [43] = {331, 86284, 2}, [44] = {334, 49425, -4}},
[11] = { [1] = {164, 0, 27}, [2] = {165, 0, 58}, [3] = {166, 0, 91}, [4] = {167, 0, 129}, [5] = {168, 0, 170}, [6] = {169, 0, 213}, [7] = {170, 0, 256}, [8] = {171, 9379, 267}, [9] = {217, 111007, -16}, [10] = {240, 111885, -7}},
[12] = { [1] = {55, 90619122, -88}, [2] = {56, 93920348, -176}, [3] = {83, 92249083, -4}, [4] = {84, 94812594, -8}, [5] = {85, 93688938, -11}, [6] = {86, 92849034, -15}, [7] = {90, 47344731, -56}, [8] = {91, 46480590, -113}, [9] = {102, 38586068, -82}, [10] = {103, 37877927, -158}, [11] = {104, 47689387, -202}, [12] = {225, 49353595, 3}, [13] = {227, 51658579, 5}, [14] = {228, 46239818, 7}, [15] = {237, 90601910, -5}, [16] = {238, 95335551, -8}, [17] = {240, 97326385, -4}, [18] = {241, 90473211, -9}, [19] = {242, 79105528, -14}, [20] = {246, 81631563, -5}, [21] = {255, 33907294, -3}, [22] = {273, 46987680, 5}, [23] = {311, 107813134, -10}, [24] = {334, 81153537, -5}},
[13] = { [1] = {15, 120761, -4}, [2] = {18, 118118, 4}, [3] = {19, 117495, 7}, [4] = {20, 106701, 10}, [5] = {49, 221249, -5}, [6] = {54, 164097, -8}, [7] = {74, 238358, -5}, [8] = {78, 256657, -4}, [9] = {110, 247244, -10}, [10] = {111, 191779, -13}, [11] = {133, 180956, -9}},
[14] = { [1] = {49, 3857213, -62}, [2] = {50, 3791446, -127}, [3] = {52, 3482212, -61}, [4] = {53, 1888441, -93}, [5] = {65, 3159667, -65}, [6] = {70, 3545368, -51}, [7] = {71, 3453822, -102}, [8] = {76, 3280645, -55}, [9] = {84, 3627942, -4}, [10] = {85, 3294953, -6}, [11] = {86, 3345369, -9}, [12] = {87, 3096850, -13}, [13] = {94, 1440981, -57}, [14] = {95, 870205, -92}, [15] = {96, 796216, -124}, [16] = {100, 1474109, -57}, [17] = {105, 1651076, -31}, [18] = {115, 1454964, -50}, [19] = {116, 811535, -79}, [20] = {118, 1552772, -33}, [21] = {126, 1536718, -27}, [22] = {127, 1496178, -65}, [23] = {162, 1387416, 4}, [24] = {163, 1380472, 7}, [25] = {172, 887688, -37}, [26] = {225, 1179232, 3}, [27] = {226, 1377971, 10}, [28] = {227, 1282577, 19}, [29] = {228, 816944, 28}, [30] = {229, 774799, 38}, [31] = {230, 1384791, 44}, [32] = {234, 5377838, -6}, [33] = {236, 1788838, -7}, [34] = {237, 3197019, -9}, [35] = {254, 3153336, 5}, [36] = {255, 3243546, -6}, [37] = {285, 2185358, 7}, [38] = {286, 4170613, 11}, [39] = {311, 4796399, -19}, [40] = {334, 2884467, -5}},
[15] = { [1] = {116, 33, 3}, [2] = {168, 97, 11}, [3] = {169, 135, 18}, [4] = {190, 132, 6}, [5] = {196, 125, 2}, [6] = {233, 116, 8}, [7] = {250, 173, 4}, [8] = {251, 258, 7}, [9] = {252, 272, 13}, [10] = {253, 184, 20}, [11] = {254, 267, 29}, [12] = {261, 6081, -5}, [13] = {263, 198, 5}, [14] = {264, 263, 13}, [15] = {266, 296, 3}, [16] = {272, 336, 4}, [17] = {277, 1083, 3}, [18] = {278, 549, 8}, [19] = {281, 572, 5}, [20] = {283, 9841, -3}, [21] = {284, 3760, 2}, [22] = {293, 9101, -5}, [23] = {295, 2134, -4}, [24] = {300, 1184, 3}, [25] = {308, 11242, -2}, [26] = {324, 362, 5}, [27] = {325, 490, 7}, [28] = {327, 481, 4}},
[16] = { [1] = {47, 9654548, -61}, [2] = {48, 12614867, -136}, [3] = {49, 12775630, -210}, [4] = {50, 12198134, -284}, [5] = {51, 8, 73}, [6] = {52, 3, 147}, [7] = {53, 0, 212}, [8] = {54, 0, 253}, [9] = {59, 9499179, -73}, [10] = {60, 7561386, -137}, [11] = {63, 10968991, -74}, [12] = {64, 10707601, -146}, [13] = {74, 8325059, -48}, [14] = {75, 8361254, -99}, [15] = {79, 11052554, -74}, [16] = {80, 10513019, -133}, [17] = {83, 10462685, -73}, [18] = {84, 11137174, -137}, [19] = {85, 10887432, -198}, [20] = {93, 7726629, -40}, [21] = {113, 6424466, -55}, [22] = {126, 7209418, -60}, [23] = {176, 7836713, -3}, [24] = {182, 6338757, -57}, [25] = {190, 3953235, -32}, [26] = {192, 6704666, -21}, [27] = {195, 7005399, -10}, [28] = {226, 6839265, 4}, [29] = {227, 6561874, 6}, [30] = {228, 5039996, 10}, [31] = {237, 12467864, -5}, [32] = {238, 11722769, -7}, [33] = {254, 11044915, 4}, [34] = {255, 9443225, -5}, [35] = {285, 10143125, 4}, [36] = {286, 14080952, 6}, [37] = {311, 14764978, -16}, [38] = {329, 21762807, 3}, [39] = {334, 14591347, -11}},
[17] = { [1] = {14, 116462, -32}, [2] = {15, 113196, -65}, [3] = {16, 111350, -100}, [4] = {17, 103668, -133}, [5] = {81, 0, 40}, [6] = {82, 0, 87}, [7] = {83, 0, 132}, [8] = {84, 0, 176}, [9] = {85, 0, 219}, [10] = {86, 0, 261}, [11] = {87, 0, 302}, [12] = {112, 128231, 5}, [13] = {114, 117011, 4}, [14] = {175, 129757, -3}, [15] = {203, 150359, 3}, [16] = {204, 148848, 6}, [17] = {223, 171967, -4}, [18] = {228, 136513, 5}, [19] = {229, 172920, 12}, [20] = {254, 220504, -17}, [21] = {310, 372553, -22}, [22] = {311, 284640, -26}, [23] = {315, 388592, 5}, [24] = {321, 442713, 5}, [25] = {323, 420755, 4}, [26] = {324, 402683, 7}, [27] = {329, 824961, -4}, [28] = {330, 875903, -7}, [29] = {333, 316466, -13}},
[18] = { [1] = {14, 38529, -27}, [2] = {15, 37416, -54}, [3] = {16, 36835, -83}, [4] = {17, 34306, -111}, [5] = {81, 0, 33}, [6] = {82, 0, 72}, [7] = {83, 0, 110}, [8] = {84, 0, 146}, [9] = {85, 0, 182}, [10] = {86, 0, 217}, [11] = {87, 0, 251}, [12] = {112, 42435, 5}, [13] = {114, 38826, 4}, [14] = {175, 42977, -3}, [15] = {203, 50070, 3}, [16] = {204, 49644, 6}, [17] = {223, 57139, -4}, [18] = {228, 45334, 5}, [19] = {229, 57424, 12}, [20] = {254, 73248, -17}, [21] = {310, 124049, -22}, [22] = {311, 94810, -26}, [23] = {315, 129375, 5}, [24] = {321, 147378, 5}, [25] = {323, 140090, 4}, [26] = {324, 134047, 7}, [27] = {329, 274758, -4}, [28] = {330, 291749, -7}, [29] = {333, 105458, -13}},
[19] = {},
[20] = { [1] = {61, 2327, -7}, [2] = {148, 2286, -8}, [3] = {156, 2173, 2}, [4] = {159, 2073, 2}, [5] = {175, 2108, -11}, [6] = {182, 221, 3}, [7] = {187, 2185, 3}, [8] = {217, 1951, 3}, [9] = {254, 2033, -11}, [10] = {310, 1797, -13}, [11] = {327, 1741, -7}, [12] = {333, 443, -4}},
[21] = { [1] = {27, 933, -10}, [2] = {32, 1011, -11}, [3] = {33, 957, -23}, [4] = {37, 925, -8}, [5] = {38, 906, -14}, [6] = {58, 0, 11}, [7] = {59, 0, 18}, [8] = {60, 0, 31}, [9] = {61, 0, 45}, [10] = {62, 0, 56}, [11] = {83, 861, -12}, [12] = {96, 839, -8}, [13] = {118, 679, 3}, [14] = {121, 1015, -7}, [15] = {131, 1133, 4}, [16] = {138, 1758, -6}},
[22] = {},
[23] = { [1] = {16, 4455, -4}, [2] = {17, 276, 3}, [3] = {18, 6081, -5}, [4] = {21, 606, 2}, [5] = {22, 404, -3}, [6] = {23, 276, -6}, [7] = {24, 276, -8}, [8] = {25, 276, -12}, [9] = {29, 42, 4}, [10] = {30, 16, 10}, [11] = {32, 16, 10}, [12] = {33, 0, 15}, [13] = {34, 0, 27}, [14] = {35, 34, 29}, [15] = {46, 15, 8}, [16] = {67, 15, 6}, [17] = {73, 52, 17}, [18] = {80, 53, 2}},
[24] = { [1] = {27, 342774, -17}, [2] = {29, 302665, -3}, [3] = {32, 378375, 4}, [4] = {38, 442546, 4}, [5] = {40, 432718, 3}, [6] = {41, 400420, 6}, [7] = {45, 1173827, 3}, [8] = {47, 981777, -3}, [9] = {48, 916939, -27}, [10] = {49, 910363, -84}, [11] = {50, 894366, -131}, [12] = {51, 903013, -161}, [13] = {56, 16, 47}, [14] = {57, 16, 91}, [15] = {58, 16, 119}, [16] = {59, 16, 142}, [17] = {60, 9, 187}, [18] = {61, 15, 215}, [19] = {65, 812499, 4}, [20] = {77, 736370, -4}, [21] = {78, 1166979, -7}, [22] = {81, 647421, -5}, [23] = {96, 404910, -5}, [24] = {121, 387946, -3}, [25] = {183, 211494, 4}, [26] = {184, 289399, 7}},
[25] = { [1] = {56, 0, 3}, [2] = {57, 0, 10}, [3] = {58, 0, 19}, [4] = {59, 0, 28}, [5] = {60, 0, 34}, [6] = {65, 499, -2}, [7] = {66, 482, -5}, [8] = {81, 131, -4}, [9] = {85, 163, -5}, [10] = {210, 49, 3}, [11] = {211, 16, 7}, [12] = {212, 19, 9}},
[26] = { [1] = {18, 192, -3}, [2] = {19, 186, -6}, [3] = {20, 189, -9}, [4] = {44, 5, 23}, [5] = {45, 7, 46}, [6] = {46, 10, 65}, [7] = {47, 5, 88}, [8] = {56, 7, 29}, [9] = {57, 6, 64}, [10] = {58, 2, 94}, [11] = {59, 2, 114}, [12] = {60, 3, 139}, [13] = {61, 2, 169}, [14] = {63, 61856, -2}, [15] = {71, 31567, -4}, [16] = {72, 60631, -5}, [17] = {80, 50006, -5}, [18] = {81, 41824, -10}, [19] = {82, 40108, -16}, [20] = {83, 42475, -24}, [21] = {84, 20160, -29}, [22] = {85, 10783, -35}, [23] = {86, 10855, -42}, [24] = {87, 9284, -47}, [25] = {88, 7745, -53}, [26] = {89, 7188, -63}, [27] = {92, 958, -3}, [28] = {93, 966, -6}, [29] = {96, 523, -5}, [30] = {130, 240, 4}, [31] = {132, 235, 7}, [32] = {135, 617, 16}, [33] = {136, 887, 27}, [34] = {137, 788, 38}, [35] = {138, 1047, 52}, [36] = {139, 725, 57}, [37] = {140, 523, 66}, [38] = {141, 495, 71}, [39] = {147, 523, 6}, [40] = {148, 495, 7}, [41] = {161, 913, 9}, [42] = {162, 982, 19}, [43] = {163, 1604, 22}, [44] = {164, 1639, 23}, [45] = {206, 797, 6}, [46] = {221, 677, 3}, [47] = {224, 458, 6}}
}

local zz = 0

for line in io.lines(filePath) do
	local tokens = {}
	local index = 0
	for token in string.gmatch(line,"[_.%w]+") do
		index = index + 1
		tokens[index] = token
	end

	if(tokens[2] == "1d") then

		zz = zz + 1

		if(zz >= 0) then

			local name = tokens[1]
			--print(name)

			local graph = {}
			local size = index/3 - 1

			for ii = 1,size do
				local triple = {}
				triple[1] = tonumber(tokens[3*ii + 1])
				triple[2] = tonumber(tokens[3*ii + 2])
				triple[3] = tonumber(tokens[3*ii + 3])
				graph[ii] = triple
			end

			local result = calculate_fdi(0, 86400, graph)

			--[[for key,value in pairs(result) do
				print(key)
				print(value[1])
				print(value[2])
				print(value[3])
		  end]]

			local tdind = 0
			for key,value in pairs(result) do
				if(value[2]) then
						local td = key-1
						tdind = tdind + 1
						assert(matlab[zz][tdind][1] == td, string.format('failed test alarm: signal num = %d, alert num = %d, got %d instead of %d', zz, tdind, td, matlab[zz][tdind][1]))
						assert(matlab[zz][tdind][2] == math.floor(value[3]+0.5), string.format('failed test estimated: signal num = %d, alert num = %d, got %d instead of %d', zz, tdind, math.floor(value[3]+0.5), matlab[zz][tdind][2]))
						assert(matlab[zz][tdind][3] == value[4], string.format('failed test ano-measure: signal num = %d, alert num = %d, got %d instead of %d', zz, tdind, value[4], matlab[zz][tdind][3]))
				end
			end
		  assert(tdind == table.getn(matlab[zz]), string.format('failed test: signal num = %d, entries num = %d, expected = %d',zz, tdind, table.getn(matlab[zz])))
		end
	end
end
