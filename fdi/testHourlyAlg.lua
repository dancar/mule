require 'calculate_fdi'

local filePath = './fdi/fixtures/graphs_of_interest.txt'
--local filePath = './fixtures/graphs_of_interest.txt'

local matlab = {
[1] = { [1] = {1602, 2}, [2] = {1603, 2}, [3] = {1604, 2}, [4] = {1605, 2}, [5] = {1606, 2}, [6] = {1607, 2}, [7] = {1608, 2}, [8] = {1609, 2}, [9] = {1610, 2}, [10] = {1611, 2}, [11] = {1612, 2}, [12] = {1613, 2}, [13] = {1614, 2}, [14] = {1615, 2}, [15] = {1616, 2}, [16] = {1617, 2}, [17] = {1618, 2}, [18] = {1619, 2}, [19] = {1620, 2}, [20] = {1621, 2}, [21] = {1622, 2}, [22] = {1623, 2}, [23] = {1624, 2}, [24] = {1625, 2}, [25] = {1626, 2}, [26] = {1627, 1}, [27] = {2094, 2}},
[2] = { [1] = {582, 1}, [2] = {583, 1}, [3] = {584, 1}, [4] = {1602, 2}, [5] = {1603, 2}, [6] = {1604, 2}, [7] = {1605, 2}, [8] = {1606, 2}, [9] = {1607, 2}, [10] = {1608, 2}, [11] = {1609, 2}, [12] = {1610, 2}, [13] = {1611, 2}, [14] = {1612, 2}, [15] = {1613, 2}, [16] = {1614, 2}, [17] = {1615, 2}, [18] = {1616, 2}, [19] = {1617, 2}, [20] = {1618, 2}, [21] = {1619, 2}, [22] = {1620, 2}, [23] = {1621, 2}, [24] = {1622, 2}, [25] = {1623, 2}, [26] = {1624, 2}, [27] = {1625, 2}, [28] = {1626, 2}, [29] = {1727, 1}, [30] = {1738, 1}, [31] = {1739, 1}, [32] = {1740, 1}, [33] = {1741, 1}},
[3] = { [1] = {340, 2}, [2] = {343, 2}, [3] = {344, 2}, [4] = {346, 2}, [5] = {348, 2}, [6] = {349, 2}, [7] = {357, 1}, [8] = {360, 1}, [9] = {441, 2}, [10] = {522, 1}, [11] = {551, 1}, [12] = {563, 2}, [13] = {594, 1}, [14] = {595, 1}, [15] = {635, 1}, [16] = {636, 1}, [17] = {637, 1}, [18] = {667, 1}, [19] = {699, 1}, [20] = {702, 1}, [21] = {727, 1}, [22] = {754, 1}, [23] = {764, 1}, [24] = {807, 1}, [25] = {824, 1}, [26] = {871, 1}, [27] = {872, 1}, [28] = {873, 1}, [29] = {874, 1}, [30] = {875, 1}, [31] = {880, 1}, [32] = {905, 1}, [33] = {972, 1}, [34] = {973, 1}, [35] = {1617, 1}, [36] = {1618, 1}, [37] = {1619, 1}, [38] = {1620, 1}},
[4] = { [1] = {604, 2}, [2] = {829, 2}, [3] = {1019, 1}, [4] = {1566, 1}, [5] = {1955, 2}, [6] = {2139, 2}},
[5] = { [1] = {989, 1}, [2] = {990, 1}, [3] = {991, 1}, [4] = {992, 1}, [5] = {999, 1}, [6] = {1000, 1}, [7] = {1001, 1}, [8] = {1002, 1}, [9] = {1007, 1}, [10] = {1602, 2}, [11] = {1603, 2}, [12] = {1604, 2}, [13] = {1605, 2}, [14] = {1606, 2}, [15] = {1607, 2}, [16] = {1608, 2}, [17] = {1609, 2}, [18] = {1610, 2}, [19] = {1611, 2}, [20] = {1612, 2}, [21] = {1613, 2}, [22] = {1614, 2}, [23] = {1615, 2}, [24] = {1616, 2}, [25] = {1617, 2}, [26] = {1618, 2}, [27] = {1619, 2}, [28] = {1620, 2}, [29] = {1621, 2}, [30] = {1622, 2}, [31] = {1623, 2}, [32] = {1624, 2}, [33] = {1625, 2}, [34] = {1626, 2}},
[6] = { [1] = {373, 2}, [2] = {374, 2}, [3] = {381, 2}, [4] = {392, 2}, [5] = {396, 2}, [6] = {400, 2}, [7] = {414, 2}, [8] = {428, 2}, [9] = {429, 2}, [10] = {459, 2}, [11] = {460, 2}, [12] = {465, 2}, [13] = {491, 2}, [14] = {493, 2}, [15] = {494, 2}, [16] = {495, 2}, [17] = {497, 2}, [18] = {498, 2}, [19] = {500, 2}, [20] = {501, 2}, [21] = {512, 2}, [22] = {515, 2}, [23] = {559, 2}, [24] = {568, 2}, [25] = {569, 2}, [26] = {570, 2}},
[7] = { [1] = {998, 1}, [2] = {999, 1}, [3] = {1000, 1}, [4] = {1001, 1}, [5] = {1002, 1}, [6] = {1003, 1}, [7] = {1602, 1}, [8] = {1603, 1}, [9] = {1604, 1}, [10] = {1605, 1}, [11] = {1606, 1}, [12] = {1607, 2}, [13] = {1608, 1}, [14] = {1609, 1}, [15] = {1610, 1}, [16] = {1611, 1}, [17] = {1612, 2}, [18] = {1613, 1}, [19] = {1614, 1}, [20] = {1615, 2}, [21] = {1616, 1}, [22] = {1617, 1}, [23] = {1618, 1}, [24] = {1619, 1}, [25] = {1620, 1}, [26] = {1621, 1}, [27] = {1622, 1}, [28] = {1623, 1}, [29] = {1624, 1}, [30] = {1625, 1}, [31] = {1626, 1}, [32] = {1676, 1}, [33] = {1677, 1}, [34] = {1678, 1}, [35] = {1708, 1}, [36] = {1779, 1}, [37] = {1780, 1}, [38] = {1781, 1}, [39] = {1782, 1}, [40] = {1783, 1}, [41] = {1784, 1}, [42] = {1785, 1}, [43] = {1786, 1}, [44] = {1787, 1}, [45] = {1788, 1}, [46] = {1789, 1}, [47] = {1790, 1}, [48] = {1806, 1}, [49] = {1807, 1}, [50] = {1808, 1}, [51] = {1809, 1}, [52] = {1810, 1}, [53] = {1811, 1}, [54] = {1812, 1}, [55] = {1813, 1}, [56] = {1814, 1}, [57] = {1815, 1}, [58] = {1830, 1}, [59] = {1831, 1}, [60] = {1832, 1}, [61] = {1833, 1}, [62] = {1834, 1}, [63] = {1835, 1}, [64] = {1836, 1}, [65] = {1856, 1}, [66] = {1857, 1}, [67] = {1858, 1}, [68] = {1909, 1}},
[8] = { [1] = {376, 2}, [2] = {398, 2}, [3] = {515, 2}, [4] = {516, 2}, [5] = {548, 2}, [6] = {549, 2}, [7] = {624, 2}, [8] = {625, 2}, [9] = {737, 2}, [10] = {738, 2}, [11] = {746, 2}, [12] = {747, 2}, [13] = {748, 2}, [14] = {749, 2}, [15] = {750, 2}, [16] = {964, 2}, [17] = {965, 2}, [18] = {966, 2}, [19] = {967, 2}, [20] = {968, 2}, [21] = {973, 2}, [22] = {982, 2}, [23] = {983, 2}, [24] = {984, 2}, [25] = {985, 2}, [26] = {1000, 1}, [27] = {1001, 1}, [28] = {1002, 1}, [29] = {1003, 1}, [30] = {1004, 1}, [31] = {1215, 2}, [32] = {1216, 2}, [33] = {1281, 2}, [34] = {1282, 2}, [35] = {1308, 2}, [36] = {1309, 2}, [37] = {1315, 2}, [38] = {1316, 2}, [39] = {1347, 2}, [40] = {1348, 2}, [41] = {1367, 2}, [42] = {1368, 2}, [43] = {1369, 2}, [44] = {1374, 2}, [45] = {1375, 2}, [46] = {1377, 2}, [47] = {1383, 2}, [48] = {1384, 2}, [49] = {1387, 2}, [50] = {1388, 2}, [51] = {1390, 2}, [52] = {1391, 2}, [53] = {1420, 2}, [54] = {1421, 2}, [55] = {1423, 2}, [56] = {1424, 2}, [57] = {1426, 2}, [58] = {1427, 2}, [59] = {1451, 2}, [60] = {1452, 2}, [61] = {1463, 2}, [62] = {1470, 2}, [63] = {1471, 2}, [64] = {1472, 2}, [65] = {1487, 2}, [66] = {1495, 2}, [67] = {1496, 2}, [68] = {1506, 2}, [69] = {1507, 2}, [70] = {1528, 2}, [71] = {1529, 2}, [72] = {1531, 2}, [73] = {1532, 2}, [74] = {1545, 2}, [75] = {1546, 2}, [76] = {1601, 2}, [77] = {1602, 2}, [78] = {1603, 2}, [79] = {1604, 2}, [80] = {1605, 2}, [81] = {1606, 2}, [82] = {1607, 2}, [83] = {1608, 2}, [84] = {1609, 2}, [85] = {1610, 2}, [86] = {1611, 2}, [87] = {1612, 2}, [88] = {1613, 2}, [89] = {1614, 2}, [90] = {1615, 2}, [91] = {1616, 2}, [92] = {1617, 2}, [93] = {1618, 2}, [94] = {1619, 2}, [95] = {1620, 2}, [96] = {1621, 2}, [97] = {1622, 2}, [98] = {1623, 2}, [99] = {1624, 2}, [100] = {1625, 2}, [101] = {1728, 2}, [102] = {1729, 2}, [103] = {1751, 2}, [104] = {1752, 2}, [105] = {1788, 2}, [106] = {1789, 2}, [107] = {1791, 2}, [108] = {1792, 2}, [109] = {1830, 2}, [110] = {1831, 2}, [111] = {1876, 2}, [112] = {1877, 2}, [113] = {1879, 2}, [114] = {1880, 2}, [115] = {1899, 2}, [116] = {1900, 2}, [117] = {1901, 2}, [118] = {1904, 2}, [119] = {1905, 2}, [120] = {1906, 2}, [121] = {1937, 2}, [122] = {1938, 2}, [123] = {1939, 2}, [124] = {1940, 2}, [125] = {1946, 2}, [126] = {1947, 2}, [127] = {1955, 2}, [128] = {1956, 2}, [129] = {1957, 2}, [130] = {1960, 2}, [131] = {1961, 2}, [132] = {1962, 2}, [133] = {1984, 2}, [134] = {1985, 2}, [135] = {1999, 2}, [136] = {2000, 2}, [137] = {2003, 2}, [138] = {2004, 2}, [139] = {2034, 2}, [140] = {2035, 2}, [141] = {2040, 2}, [142] = {2041, 2}, [143] = {2056, 2}, [144] = {2057, 2}, [145] = {2059, 2}, [146] = {2060, 2}, [147] = {2061, 2}, [148] = {2131, 2}, [149] = {2132, 2}, [150] = {2142, 2}, [151] = {2143, 2}},
[9] = { [1] = {991, 1}, [2] = {992, 1}, [3] = {1000, 1}, [4] = {1001, 1}, [5] = {1002, 1}, [6] = {1601, 2}, [7] = {1602, 2}, [8] = {1603, 2}, [9] = {1604, 2}, [10] = {1605, 2}, [11] = {1606, 2}, [12] = {1607, 2}, [13] = {1608, 2}, [14] = {1609, 2}, [15] = {1610, 2}, [16] = {1611, 2}, [17] = {1612, 2}, [18] = {1613, 2}, [19] = {1614, 2}, [20] = {1615, 2}, [21] = {1616, 2}, [22] = {1617, 2}, [23] = {1618, 2}, [24] = {1619, 2}, [25] = {1620, 2}, [26] = {1621, 2}, [27] = {1622, 2}, [28] = {1623, 2}, [29] = {1624, 2}, [30] = {1625, 2}, [31] = {1626, 2}, [32] = {1952, 1}, [33] = {1980, 1}, [34] = {1981, 1}},
[10] = { [1] = {1184, 1}, [2] = {1185, 1}, [3] = {1186, 1}, [4] = {1206, 1}, [5] = {1207, 1}, [6] = {1208, 1}, [7] = {1235, 1}, [8] = {1602, 1}, [9] = {1603, 1}, [10] = {1604, 1}, [11] = {1605, 1}, [12] = {1606, 1}, [13] = {1607, 2}, [14] = {1608, 2}, [15] = {1609, 2}, [16] = {1610, 2}, [17] = {1611, 2}, [18] = {1612, 2}, [19] = {1613, 2}, [20] = {1614, 2}, [21] = {1615, 2}, [22] = {1616, 2}, [23] = {1617, 2}, [24] = {1618, 2}, [25] = {1619, 2}, [26] = {1620, 2}, [27] = {1621, 2}, [28] = {1622, 2}, [29] = {1623, 1}, [30] = {1624, 1}, [31] = {1625, 1}, [32] = {1626, 1}, [33] = {1767, 1}, [34] = {1773, 1}, [35] = {1774, 1}, [36] = {1775, 1}, [37] = {1776, 1}, [38] = {1777, 1}, [39] = {1778, 1}, [40] = {1779, 1}, [41] = {1780, 1}, [42] = {1781, 1}, [43] = {1782, 1}, [44] = {1783, 1}, [45] = {1784, 1}, [46] = {1785, 1}, [47] = {1786, 1}, [48] = {1787, 1}, [49] = {1788, 1}, [50] = {1789, 1}, [51] = {1790, 1}, [52] = {1791, 1}, [53] = {1792, 1}, [54] = {1793, 1}, [55] = {1794, 1}, [56] = {1800, 1}, [57] = {1801, 1}, [58] = {1802, 1}, [59] = {1803, 1}, [60] = {1804, 1}, [61] = {1805, 1}, [62] = {1806, 1}, [63] = {1807, 1}, [64] = {1808, 1}, [65] = {1809, 1}, [66] = {1810, 1}, [67] = {1811, 1}, [68] = {1812, 1}, [69] = {1813, 1}, [70] = {1814, 1}, [71] = {1815, 1}, [72] = {1816, 1}, [73] = {1817, 1}, [74] = {1818, 1}, [75] = {1825, 1}, [76] = {1826, 1}, [77] = {1827, 1}, [78] = {1833, 1}, [79] = {1834, 1}, [80] = {1835, 1}, [81] = {1836, 1}, [82] = {1837, 1}, [83] = {1838, 1}, [84] = {1839, 1}, [85] = {1840, 1}, [86] = {1841, 1}, [87] = {1842, 1}, [88] = {1850, 1}, [89] = {1851, 1}, [90] = {1852, 1}, [91] = {1853, 1}, [92] = {1854, 1}, [93] = {1855, 1}, [94] = {1856, 1}, [95] = {1857, 1}, [96] = {1858, 1}, [97] = {1859, 1}, [98] = {1860, 1}, [99] = {1861, 1}, [100] = {1862, 1}, [101] = {1863, 1}, [102] = {1864, 1}, [103] = {1865, 1}, [104] = {1866, 1}, [105] = {1875, 1}, [106] = {1876, 1}, [107] = {1877, 1}, [108] = {1878, 1}, [109] = {1879, 1}, [110] = {1880, 1}, [111] = {1881, 1}, [112] = {1882, 1}, [113] = {1883, 1}, [114] = {1884, 1}, [115] = {1885, 1}, [116] = {1886, 1}, [117] = {1887, 1}, [118] = {1888, 1}, [119] = {1889, 1}, [120] = {1904, 1}, [121] = {1905, 1}, [122] = {2077, 1}},
[11] = { [1] = {1097, 1}, [2] = {1266, 2}, [3] = {1267, 2}, [4] = {1268, 2}, [5] = {1269, 2}, [6] = {1270, 2}, [7] = {1271, 2}, [8] = {1272, 2}, [9] = {1273, 2}, [10] = {1274, 2}, [11] = {1275, 2}, [12] = {1276, 2}, [13] = {1277, 2}, [14] = {1278, 2}, [15] = {1279, 2}, [16] = {1280, 2}, [17] = {1281, 2}, [18] = {1282, 2}, [19] = {1283, 2}, [20] = {1284, 2}, [21] = {1285, 2}, [22] = {1286, 2}, [23] = {1287, 2}, [24] = {1288, 2}, [25] = {1289, 2}, [26] = {1290, 2}},
[12] = { [1] = {1602, 2}, [2] = {1603, 2}, [3] = {1604, 2}, [4] = {1605, 2}, [5] = {1606, 2}, [6] = {1607, 2}, [7] = {1608, 2}, [8] = {1609, 2}, [9] = {1610, 2}, [10] = {1611, 2}, [11] = {1612, 2}, [12] = {1613, 2}, [13] = {1614, 2}, [14] = {1615, 2}, [15] = {1616, 2}, [16] = {1617, 2}, [17] = {1618, 2}, [18] = {1619, 2}, [19] = {1620, 2}, [20] = {1621, 2}, [21] = {1622, 2}, [22] = {1623, 2}, [23] = {1624, 2}, [24] = {1625, 2}, [25] = {1626, 2}},
[13] = { [1] = {675, 1}, [2] = {704, 1}, [3] = {705, 1}, [4] = {706, 2}, [5] = {707, 2}, [6] = {708, 2}, [7] = {709, 1}, [8] = {726, 1}, [9] = {853, 1}, [10] = {1603, 1}, [11] = {1604, 2}, [12] = {1605, 2}, [13] = {1606, 2}, [14] = {1607, 2}, [15] = {1608, 2}, [16] = {1609, 2}, [17] = {1610, 2}, [18] = {1611, 2}, [19] = {1612, 2}, [20] = {1613, 2}, [21] = {1614, 2}, [22] = {1615, 2}, [23] = {1616, 2}, [24] = {1617, 2}, [25] = {1618, 2}, [26] = {1619, 2}, [27] = {1620, 2}, [28] = {1621, 2}, [29] = {1622, 2}, [30] = {1623, 2}, [31] = {1624, 2}, [32] = {1625, 2}, [33] = {1626, 2}, [34] = {1627, 2}, [35] = {1628, 2}, [36] = {1629, 2}, [37] = {1630, 2}, [38] = {1631, 2}, [39] = {1632, 2}, [40] = {1633, 2}, [41] = {1636, 1}, [42] = {1637, 2}, [43] = {1638, 2}, [44] = {1639, 2}},
[14] = { [1] = {988, 1}, [2] = {989, 1}, [3] = {990, 1}, [4] = {991, 1}, [5] = {1000, 1}, [6] = {1001, 1}, [7] = {1002, 1}, [8] = {1003, 1}, [9] = {1004, 1}, [10] = {1005, 1}, [11] = {1006, 1}, [12] = {1007, 1}, [13] = {1029, 1}, [14] = {1030, 1}, [15] = {1031, 1}, [16] = {1052, 1}, [17] = {1187, 1}, [18] = {1602, 2}, [19] = {1603, 2}, [20] = {1604, 2}, [21] = {1605, 2}, [22] = {1606, 2}, [23] = {1607, 2}, [24] = {1608, 2}, [25] = {1609, 2}, [26] = {1610, 2}, [27] = {1611, 2}, [28] = {1612, 2}, [29] = {1613, 2}, [30] = {1614, 2}, [31] = {1615, 2}, [32] = {1616, 2}, [33] = {1617, 2}, [34] = {1618, 2}, [35] = {1619, 2}, [36] = {1620, 2}, [37] = {1621, 2}, [38] = {1622, 2}, [39] = {1623, 2}, [40] = {1624, 2}, [41] = {1625, 2}, [42] = {1626, 2}},
[15] = { [1] = {396, 2}, [2] = {403, 2}, [3] = {500, 2}, [4] = {821, 1}, [5] = {822, 1}, [6] = {833, 1}, [7] = {843, 2}, [8] = {876, 1}, [9] = {1000, 1}, [10] = {1004, 1}, [11] = {1005, 1}, [12] = {1372, 1}, [13] = {1373, 1}, [14] = {1374, 1}, [15] = {1375, 1}, [16] = {1376, 1}, [17] = {1377, 1}, [18] = {1378, 1}, [19] = {1379, 1}, [20] = {1380, 1}, [21] = {1381, 1}, [22] = {1382, 1}, [23] = {1383, 1}, [24] = {1384, 1}, [25] = {1385, 1}, [26] = {1386, 1}, [27] = {1387, 1}, [28] = {1388, 1}, [29] = {1389, 1}, [30] = {1390, 1}, [31] = {1730, 1}, [32] = {1738, 1}, [33] = {1893, 1}, [34] = {1920, 1}, [35] = {1941, 1}, [36] = {1957, 1}, [37] = {1985, 1}, [38] = {1986, 1}, [39] = {1987, 1}, [40] = {1988, 1}, [41] = {1989, 1}, [42] = {1990, 1}, [43] = {1991, 1}},
[16] = { [1] = {882, 2}, [2] = {985, 2}, [3] = {988, 1}, [4] = {989, 1}, [5] = {990, 1}, [6] = {991, 1}, [7] = {1000, 1}, [8] = {1001, 1}, [9] = {1002, 1}, [10] = {1003, 1}, [11] = {1004, 1}, [12] = {1005, 1}, [13] = {1030, 1}, [14] = {1031, 1}, [15] = {1601, 2}, [16] = {1602, 3}, [17] = {1603, 3}, [18] = {1604, 3}, [19] = {1605, 3}, [20] = {1606, 3}, [21] = {1607, 3}, [22] = {1608, 3}, [23] = {1609, 3}, [24] = {1610, 3}, [25] = {1611, 3}, [26] = {1612, 3}, [27] = {1613, 3}, [28] = {1614, 3}, [29] = {1615, 3}, [30] = {1616, 3}, [31] = {1617, 3}, [32] = {1618, 3}, [33] = {1619, 3}, [34] = {1620, 3}, [35] = {1621, 3}, [36] = {1622, 3}, [37] = {1623, 3}, [38] = {1624, 3}, [39] = {1625, 3}, [40] = {1626, 3}, [41] = {1779, 1}, [42] = {1780, 1}, [43] = {1892, 1}, [44] = {1893, 1}, [45] = {2037, 1}, [46] = {2038, 1}, [47] = {2039, 1}},
[17] = { [1] = {485, 2}, [2] = {618, 2}, [3] = {705, 2}, [4] = {706, 2}, [5] = {707, 2}, [6] = {708, 2}, [7] = {709, 2}, [8] = {867, 2}, [9] = {1176, 2}, [10] = {1177, 2}, [11] = {1602, 2}, [12] = {1603, 2}, [13] = {1604, 2}, [14] = {1605, 2}, [15] = {1606, 2}, [16] = {1607, 2}, [17] = {1608, 2}, [18] = {1609, 2}, [19] = {1610, 2}, [20] = {1611, 2}, [21] = {1612, 2}, [22] = {1613, 2}, [23] = {1614, 2}, [24] = {1615, 2}, [25] = {1616, 2}, [26] = {1617, 2}, [27] = {1618, 2}, [28] = {1619, 2}, [29] = {1620, 2}, [30] = {1621, 2}, [31] = {1622, 2}, [32] = {1623, 2}, [33] = {1624, 2}, [34] = {1625, 2}, [35] = {1626, 2}, [36] = {1627, 2}, [37] = {1628, 2}, [38] = {1629, 2}, [39] = {1630, 2}, [40] = {1631, 2}, [41] = {1632, 2}, [42] = {1633, 2}, [43] = {1634, 2}, [44] = {1637, 1}, [45] = {1638, 2}, [46] = {1639, 2}, [47] = {1640, 2}, [48] = {1723, 1}, [49] = {1724, 1}, [50] = {1725, 1}, [51] = {1726, 1}, [52] = {1727, 1}, [53] = {1728, 1}, [54] = {1729, 1}, [55] = {1730, 1}, [56] = {1731, 1}, [57] = {1732, 1}, [58] = {1739, 1}, [59] = {1740, 1}, [60] = {1741, 1}, [61] = {1742, 1}, [62] = {1743, 1}, [63] = {1744, 1}, [64] = {1868, 1}, [65] = {1869, 1}, [66] = {1870, 1}, [67] = {1871, 1}, [68] = {1872, 1}, [69] = {1873, 1}, [70] = {1874, 1}, [71] = {1875, 1}, [72] = {1876, 1}, [73] = {1877, 1}, [74] = {1878, 1}, [75] = {1879, 1}, [76] = {1880, 1}, [77] = {1881, 1}, [78] = {1882, 1}, [79] = {1883, 1}, [80] = {1884, 1}, [81] = {1885, 1}, [82] = {1886, 1}, [83] = {1887, 1}, [84] = {1888, 1}, [85] = {1916, 1}, [86] = {1917, 1}, [87] = {1918, 1}, [88] = {1919, 1}, [89] = {1920, 1}, [90] = {1941, 1}, [91] = {1942, 1}, [92] = {1943, 1}, [93] = {1944, 1}, [94] = {1945, 1}, [95] = {1946, 1}, [96] = {1947, 1}, [97] = {1948, 1}, [98] = {1971, 1}, [99] = {1972, 1}, [100] = {1992, 1}, [101] = {1993, 1}},
[18] = { [1] = {485, 2}, [2] = {618, 2}, [3] = {705, 2}, [4] = {706, 2}, [5] = {707, 2}, [6] = {708, 2}, [7] = {709, 2}, [8] = {867, 2}, [9] = {1602, 2}, [10] = {1603, 2}, [11] = {1604, 2}, [12] = {1605, 2}, [13] = {1606, 2}, [14] = {1607, 2}, [15] = {1608, 2}, [16] = {1609, 2}, [17] = {1610, 2}, [18] = {1611, 2}, [19] = {1612, 2}, [20] = {1613, 2}, [21] = {1614, 2}, [22] = {1615, 2}, [23] = {1616, 2}, [24] = {1617, 2}, [25] = {1618, 2}, [26] = {1619, 2}, [27] = {1620, 2}, [28] = {1621, 2}, [29] = {1622, 2}, [30] = {1623, 2}, [31] = {1624, 2}, [32] = {1625, 2}, [33] = {1626, 2}, [34] = {1627, 2}, [35] = {1628, 2}, [36] = {1629, 2}, [37] = {1630, 2}, [38] = {1631, 2}, [39] = {1632, 2}, [40] = {1633, 2}, [41] = {1634, 2}, [42] = {1637, 1}, [43] = {1638, 2}, [44] = {1639, 2}, [45] = {1640, 2}, [46] = {1723, 1}, [47] = {1724, 1}, [48] = {1725, 1}, [49] = {1726, 1}, [50] = {1727, 1}, [51] = {1728, 1}, [52] = {1729, 1}, [53] = {1730, 1}, [54] = {1731, 1}, [55] = {1732, 1}, [56] = {1738, 1}, [57] = {1743, 1}, [58] = {1869, 1}, [59] = {1870, 1}, [60] = {1871, 1}, [61] = {1872, 1}, [62] = {1873, 1}, [63] = {1874, 1}, [64] = {1875, 1}, [65] = {1876, 1}, [66] = {1877, 1}, [67] = {1878, 1}, [68] = {1879, 1}, [69] = {1880, 1}, [70] = {1881, 1}, [71] = {1882, 1}, [72] = {1883, 1}, [73] = {1884, 1}, [74] = {1885, 1}, [75] = {1886, 1}, [76] = {1887, 1}, [77] = {1888, 1}, [78] = {1916, 1}, [79] = {1921, 1}, [80] = {1922, 1}, [81] = {1923, 1}, [82] = {1924, 1}, [83] = {1941, 1}, [84] = {1942, 1}, [85] = {1943, 1}, [86] = {1944, 1}, [87] = {1971, 1}, [88] = {1972, 1}, [89] = {1994, 1}, [90] = {1995, 1}, [91] = {1996, 1}, [92] = {1997, 1}, [93] = {1998, 1}},
[19] = {},
[20] = { [1] = {726, 1}, [2] = {1445, 1}, [3] = {1620, 1}, [4] = {1621, 1}, [5] = {2027, 1}},
[21] = { [1] = {714, 1}, [2] = {738, 1}},
[22] = { [1] = {1625, 2}, [2] = {1626, 2}, [3] = {1627, 2}, [4] = {1628, 2}, [5] = {1629, 2}, [6] = {1630, 2}, [7] = {1631, 2}, [8] = {1640, 2}, [9] = {1641, 2}, [10] = {1642, 2}, [11] = {1643, 2}, [12] = {1655, 2}, [13] = {1656, 2}, [14] = {1657, 2}, [15] = {1658, 2}, [16] = {1659, 2}, [17] = {1660, 2}, [18] = {1661, 2}, [19] = {1662, 2}, [20] = {1664, 2}, [21] = {1667, 1}, [22] = {1689, 1}, [23] = {1690, 1}, [24] = {1691, 1}, [25] = {1692, 1}, [26] = {1713, 1}, [27] = {1714, 1}, [28] = {1715, 1}, [29] = {1716, 1}, [30] = {1737, 1}, [31] = {1738, 1}, [32] = {1739, 1}, [33] = {1747, 2}, [34] = {1761, 1}, [35] = {1762, 1}, [36] = {1785, 1}, [37] = {1786, 1}, [38] = {1822, 2}, [39] = {1831, 2}, [40] = {1836, 1}, [41] = {1837, 1}, [42] = {1838, 1}, [43] = {1839, 1}, [44] = {1840, 1}, [45] = {1841, 1}, [46] = {1842, 1}, [47] = {1843, 1}, [48] = {1844, 1}, [49] = {1845, 1}, [50] = {1846, 1}, [51] = {1847, 1}, [52] = {1848, 1}, [53] = {1849, 1}, [54] = {1850, 1}, [55] = {1851, 1}, [56] = {1852, 1}, [57] = {1853, 1}, [58] = {1854, 1}, [59] = {1855, 1}, [60] = {1856, 1}, [61] = {1864, 1}, [62] = {1865, 1}, [63] = {1866, 1}, [64] = {1867, 1}, [65] = {1868, 1}, [66] = {1869, 1}, [67] = {1870, 1}, [68] = {1871, 1}, [69] = {1872, 1}, [70] = {1873, 1}, [71] = {1874, 1}, [72] = {1875, 1}, [73] = {1876, 1}, [74] = {1877, 1}, [75] = {1878, 1}, [76] = {1879, 1}, [77] = {1880, 1}, [78] = {1889, 1}, [79] = {1890, 1}, [80] = {1891, 1}, [81] = {1892, 1}, [82] = {1893, 1}, [83] = {1894, 1}, [84] = {1895, 1}, [85] = {1896, 1}, [86] = {1897, 1}, [87] = {1898, 1}, [88] = {1899, 1}, [89] = {1900, 1}, [90] = {1901, 1}, [91] = {1902, 1}, [92] = {1903, 1}, [93] = {1904, 1}, [94] = {1912, 1}, [95] = {1913, 1}, [96] = {1914, 1}, [97] = {1918, 1}, [98] = {1919, 1}, [99] = {1920, 1}, [100] = {1921, 1}, [101] = {1922, 1}, [102] = {1923, 1}, [103] = {1924, 1}, [104] = {1925, 1}, [105] = {1926, 1}, [106] = {1927, 1}, [107] = {1928, 1}, [108] = {1937, 1}, [109] = {1938, 1}, [110] = {1939, 1}, [111] = {1940, 1}, [112] = {1941, 1}, [113] = {1942, 1}, [114] = {1943, 1}, [115] = {1944, 1}, [116] = {1945, 1}, [117] = {1946, 1}, [118] = {1947, 1}, [119] = {1948, 1}, [120] = {1949, 1}, [121] = {1950, 1}, [122] = {1951, 1}, [123] = {1952, 1}, [124] = {1980, 1}, [125] = {2139, 1}, [126] = {2140, 1}, [127] = {2141, 1}, [128] = {2142, 1}, [129] = {2143, 1}, [130] = {2144, 1}, [131] = {2145, 1}, [132] = {2146, 1}, [133] = {2147, 1}, [134] = {2155, 1}, [135] = {2156, 1}, [136] = {2157, 1}}
}

local zz = 0

for line in io.lines(filePath) do
	local tokens = {}
	local index = 0
	for token in string.gmatch(line,"[_.%w]+") do
		index = index + 1
		tokens[index] = token
	end

	if(tokens[2] == "1h") then

		zz = zz + 1

		if(zz > 0) then

			local name = tokens[1]
			--print(name)

			local graph = {}
			local size = index/3 - 1

			for ii = 1,size do
				local triple = {}
				triple[1] = tonumber(tokens[3*ii + 1])
				triple[2] = tonumber(tokens[3*ii + 2])
				triple[3] = tonumber(tokens[3*ii + 3])
				graph[ii] = triple
			end

			local result = calculate_fdi(0, 3600, graph)

--[[
			for key,value in pairs(result) do
				print(key)
				print(value[1])
				print(value[2])
				print(value[3])
		  end
]]

			local tdind = 0
			for key,value in pairs(result) do
				if(value[2]) then
						local td = key - 1
						tdind = tdind + 1
						assert(matlab[zz][tdind][1] == td, string.format('failed test alarm: signal num = %d, alert num = %d, got %d instead of %d', zz, tdind, td, matlab[zz][tdind][1]))
						assert(matlab[zz][tdind][2] == value[3], string.format('failed test level: signal num = %d, alert num = %d, got %d instead of %d', zz, tdind, value[3], matlab[zz][tdind][2]))
				end
			end
			assert(tdind == table.getn(matlab[zz]), string.format('failed test: signal num = %d, entries num = %d, expected = %d',zz, tdind, table.getn(matlab[zz])))
		end
	end
end
